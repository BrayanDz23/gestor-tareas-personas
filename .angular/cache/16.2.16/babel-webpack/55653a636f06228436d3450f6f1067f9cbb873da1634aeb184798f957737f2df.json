{"ast":null,"code":"import { __decorate, __metadata } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { TareaService } from '../../services/tarea.service';\nlet CrearTareaComponent = class CrearTareaComponent {\n  constructor(fb, tareaService) {\n    this.fb = fb;\n    this.tareaService = tareaService;\n    this.habilidadesValidas = true;\n    this.tareaForm = this.fb.group({\n      id: [0],\n      nombre: ['', [Validators.required, Validators.minLength(5)]],\n      fechaLimite: ['', Validators.required],\n      personas: this.fb.array([])\n    });\n  }\n  ngOnInit() {\n    this.tareaService.tareaParaEditar.subscribe(tarea => {\n      if (tarea) {\n        this.tareaForm.patchValue({\n          id: tarea.id,\n          nombre: tarea.nombre,\n          fechaLimite: tarea.fechaLimite\n        });\n        this.tareaForm.setControl('personas', this.fb.array(tarea.personas.map(persona => this.crearPersonaFormGroup(persona))));\n      }\n    });\n  }\n  get personas() {\n    return this.tareaForm.get('personas');\n  }\n  crearPersonaFormGroup(persona) {\n    return this.fb.group({\n      nombre: [persona ? persona.nombre : '', [Validators.required, Validators.minLength(5)]],\n      edad: [persona ? persona.edad : '', [Validators.required, Validators.min(18)]],\n      habilidades: this.fb.array(persona ? persona.habilidades.map(h => this.fb.control(h)) : [this.fb.control('')])\n    });\n  }\n  agregarPersona() {\n    this.personas.push(this.crearPersonaFormGroup());\n  }\n  eliminarPersona(index) {\n    this.personas.removeAt(index);\n  }\n  agregarHabilidad(index) {\n    this.personas.at(index).get('habilidades').push(this.fb.control(''));\n    this.validarHabilidades();\n  }\n  eliminarHabilidad(personaIndex, habilidadIndex) {\n    this.personas.at(personaIndex).get('habilidades').removeAt(habilidadIndex);\n    this.validarHabilidades();\n  }\n  validarHabilidades() {\n    this.habilidadesValidas = this.personas.controls.every(persona => {\n      const habilidades = persona.get('habilidades');\n      return habilidades.length > 0 && habilidades.controls.some(h => h.value);\n    });\n  }\n  guardarTarea() {\n    if (this.tareaForm.valid && this.habilidadesValidas) {\n      const tarea = {\n        id: this.tareaForm.value.id,\n        nombre: this.tareaForm.value.nombre,\n        fechaLimite: this.tareaForm.value.fechaLimite,\n        personas: this.tareaForm.value.personas,\n        completada: false\n      };\n      if (tarea.id) {\n        this.tareaService.updateTarea(tarea);\n      } else {\n        this.tareaService.addTarea(tarea);\n      }\n      this.tareaForm.reset();\n      this.habilidadesValidas = true; // Reiniciar la validaci√≥n\n    }\n  }\n};\n\nCrearTareaComponent = __decorate([Component({\n  selector: 'app-crear-tarea',\n  templateUrl: './crear-tarea.component.html',\n  styleUrls: ['./crear-tarea.component.scss']\n}), __metadata(\"design:paramtypes\", [FormBuilder, TareaService])], CrearTareaComponent);\nexport { CrearTareaComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}